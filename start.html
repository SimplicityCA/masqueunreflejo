<!DOCTYPE html>
<html lang="en" ng-app="confusionApp">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>M&aacute;s Que Un Reflejo</title>    
        <!-- Bootstrap -->
<!-- build:css styles/main.css -->
    <link href="node_modules/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="node_modules/bootstrap/dist/css/bootstrap-theme.min.css" rel="stylesheet">
    <link href="dist/styles/master.css" rel="stylesheet">
    
<!-- endbuild -->

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

<body>
    <div id="container" class="container">
        <div class="row">
        	<div class="header col-xs-12">
              	<img src="assets/mas-que-un-reflejo.png" alt="mas que un reflejo" class="img"/>
            </div>
        </div>
        <div class="row">
            <div id="canvas-content" class="canvas-content col-xs-12">
<!--             	<canvas id="picture" style="border:1px solid #000000;" class="col-xs-6 col-xs-offset-3">
                    Your browser does not support the HTML5 canvas tag.
                </canvas> -->
                <div class="col-xs-12 col-sm-6 col-sm-offset-3 button-container">
                    <!-- <a class="btn btn-success btn-lg btn-block" href="#">Subir Foto</a> -->
                    <a id="next" class="btn btn-primary btn-common btn-lg btn-block" href="#">Comenzar</a>
                </div>
            </div>
        
            <div id="efect-content" class="efect-content col-xs-12" style="display:none;">
                <div class="col-sm-10 col-xs-12 col-md-push-2">
 <!--                    <div class="col-sm-6 canvas-container">
                        <input type="file" id="file-input">
                    </div> -->
                    <canvas id="image" style="border:1px solid #000000;"  width="625" height="500" >
                        Your browser does not support the HTML5 canvas tag.
                    </canvas>
                    <canvas id="overlay" width="625" height="500"></canvas>
                                <div style="display:none;cursor: pointer; width: 80px; opacity: 0.9; z-index: 10001; position: absolute; top: 0px;"><div style="text-align: left; line-height: 1.2em; background-color: rgb(8, 8, 24); padding: 0px 0px 3px 3px;"><div style="font-family: Helvetica, Arial, sans-serif; font-size: 9px; color: rgb(0, 255, 255); font-weight: bold;">FPS</div><div style="position: relative; width: 74px; height: 30px; background-color: rgb(0, 255, 255);"><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span><span style="width: 1px; height: 30px; float: left; background-color: rgb(16, 16, 48);"></span></div></div><div style="text-align: left; line-height: 1.2em; background-color: rgb(8, 24, 8); padding: 0px 0px 3px 3px; display: none;"><div style="font-family: Helvetica, Arial, sans-serif; font-size: 9px; color: rgb(0, 255, 0); font-weight: bold;">MS</div><div style="position: relative; width: 74px; height: 30px; background-color: rgb(0, 255, 0);"><span style="width: 1px; height: 4.27474px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 12.7846px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 29.017px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 11.4125px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 2.5707px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 16.3137px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 16.0598px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 4.85644px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 10.6508px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 21.6129px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 28.6118px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 8.51672px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 8.59362px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 10.6474px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 17.0529px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 25.0104px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 21.9584px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 0.357608px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 15.3942px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 11.8628px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 11.4635px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 29.8665px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 11.583px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 22.3665px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 26.2869px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 13.9059px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 24.5935px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 16.1896px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 28.8372px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 15.8241px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 3.75458px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 0.586976px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 21.7921px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 7.78568px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 24.8711px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 4.64035px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 14.9013px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 5.1272px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 16.9599px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 6.32179px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 23.5757px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 3.41358px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 29.9786px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 2.17336px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 9.44664px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 18.1339px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 13.5615px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 0.634406px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 10.8427px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 29.6467px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 7.33552px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 9.27873px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 17.2382px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 18.5373px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 2.24355px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 1.59073px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 0.968195px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 20.0625px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 25.853px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 9.78658px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 29.2632px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 25.5337px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 23.3443px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 4.05129px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 23.0714px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 10.1759px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 29.093px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 14.0281px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 26.2424px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 26.9029px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 5.59319px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 20.793px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 10.8222px; float: left; background-color: rgb(16, 48, 16);"></span><span style="width: 1px; height: 17.7937px; float: left; background-color: rgb(16, 48, 16);"></span></div></div></div>
                                <br>
        
            <p  style="display: none;" id="convergence"></p>
                </div>
                <div class="col-sm-2 col-xs-12 efects-container col-md-pull-10 ">
                    <a class="btn btn-success btn-lg btn-block" href="#">Efecto 1</a>
                    <a class="btn btn-info btn-lg btn-block" href="#">Efecto 2</a>
                     <a class="btn btn-warning btn-lg btn-block" href="#">Efecto 3</a>
                     <a class="btn btn-danger btn-lg btn-block" href="#">Efecto 4</a>
                </div>
                <div class="col-xs-12 col-sm-8 col-sm-offset-2 button-container">
                        <section id="colorSwatch">
                            <input type="radio" name="color" id="color01" data-color="gold" checked><label for="color01"></label> 
                            <input type="radio" name="color" id="color02" data-color="darkorange">  <label for="color02"></label>  
                            <input type="radio" name="color" id="color03" data-color="navy">        <label for="color03"></label>  
                            <input type="radio" name="color" id="color04" data-color="yellowgreen"> <label for="color04"></label>  
                            <input type="radio" name="color" id="color05" data-color="firebrick">   <label for="color05"></label>  
                            <input type="radio" name="color" id="color06" data-color="powderblue">  <label for="color06"></label> 
                        </section>
                        <div class="col-sm-6">
                            <a  class="btn btn-primary btn-common btn-lg btn-block" onclick="rotate()" href="#">Rotar</a>
                            <input id="auto-r" style="display: none;" type="button" class="btn" value="Reconocer" onclick="animateClean()">
                            <!-- <input type="button" class="btn" value="manually select face" onclick="selectBox()"> -->
                            <input type="file" id="file-input">
                        </div>
                        <div class="col-sm-6">
                            <a class="btn btn-primary btn-lg btn-block"  onclick="postCanvasToFacebook()" >Compartir en fb</a>
                        </div>
                    </div>
                
                
            </div>
        </div>
    </div>
    <footer class="footer">
	      <div class="container">
	        <img src="assets/footer-pratonato-san-jose.png" alt="mas que un reflejo" class="img"/>
	      </div>
	    </footer>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<!-- build:js scripts/main.js -->
    <script src="node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
<!-- endbuild -->
    <script src="js/pubnub-3.15.2.min.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/dat.gui.min.js"></script>
    <script src="js/numeric-1.2.6.min.js"></script>
    <script src="js/mosse.js"></script>
    <script src="js/jsfeat-min.js"></script>
    <script src="js/frontalface.js"></script>
    <script src="js/jsfeat_detect.js"></script>
    <script src="js/left_eye_filter.js"></script>
    <script src="js/right_eye_filter.js"></script>
    <script src="js/nose_filter.js"></script>
    <script src="js/model_pca_20_svm.js"></script>
    <script src="js/clm.js"></script>
    <script src="js/svmfilter_webgl.js"></script>
    <script src="js/svmfilter_fft.js"></script>
    <script src="js/mossefilter.js"></script>
    <script src="js/Stats.js"></script>
    <link rel="stylesheet" type="text/css" href="js/imgareaselect-default.css">
    <script src="js/drawcanvas.js"></script> 
    <script src="js/load-image.js"></script>
    <script src="js/load-image-scale.js"></script>
    <script src="js/load-image-meta.js"></script>
    <script src="js/load-image-fetch.js"></script>
    <script src="js/load-image-exif.js"></script>
    <script src="js/load-image-exif-map.js"></script>
    <script src="js/load-image-orientation.js"></script>
    <script src="js/vendor/jquery.Jcrop.js"></script>
    <script src="js/app.js"></script>
    <script src="js/facebook.js"></script>
    <script src="js/base64binary.js"></script>
    <script src="js/jquery.imgareaselect.pack.js"></script>
    <script>
        $(document).ready(function(){
            $("#next").on("click",function(){
                $("#canvas-content").hide();
                $("#efect-content").show();
            })
            $("#back").on("click",function(){
                $("#canvas-content").show();
                $("#efect-content").hide();
            })
        })
        function rotate () {
            var canvas = document.getElementById("image");
            var context = canvas.getContext("2d");
            var cw = canvas.width;
            var ch = canvas.height;
            var myImageData, rotating = false;
    if (!rotating) {

        rotating = true;            
        // store current data to an image
        myImageData = new Image();
        myImageData.src = canvas.toDataURL();

       myImageData.onload = function () {
            // reset the canvas with new dimensions
            canvas.width = ch;
            canvas.height = cw;
            cw = canvas.width;
            ch = canvas.height;

            context.save();
            // translate and rotate
            context.translate(cw, ch / cw);
            context.rotate(Math.PI / 2);
            // draw the previows image, now rotated
            context.drawImage(myImageData, 0, 0);               
            context.restore();

            // clear the temporary image
            myImageData = null;

            rotating = false;               
        }
    }
}
    </script>


<script>
                var cc = document.getElementById('image').getContext('2d');
                var overlay = document.getElementById('overlay');
                var overlayCC = overlay.getContext('2d');
            
                var img = new Image();
                img.onload = function() {
                    cc.drawImage(img,0,0,625, 500);
                };
                // img.src = 'assets/franck_02159.jpg';
            
                var ctrack = new clm.tracker({stopOnConvergence : true});
                ctrack.init(pModel);
            
                stats = new Stats();
                stats.domElement.style.position = 'absolute';
                stats.domElement.style.top = '0px';
                document.getElementById('container').appendChild( stats.domElement );
                
                var drawRequest;
                
                function animateClean() {
                    
                    ctrack.start(document.getElementById('image'));
                    drawLoop();
                }

                function animate(box) {
                    ctrack.start(document.getElementById('image'), box);
                    drawLoop();
                }
                
                function drawLoop() {
                    drawRequest = requestAnimFrame(drawLoop);
                    overlayCC.clearRect(0, 0, 720, 576);
                    if (ctrack.getCurrentPosition()) {
                        ctrack.draw(overlay);
                    }
                }
                
                // detect if tracker fails to find a face
                document.addEventListener("clmtrackrNotFound", function(event) {
                    ctrack.stop();
                    alert("The tracking had problems with finding a face in this image. Try selecting the face in the image manually.")
                }, false);
                
                // detect if tracker loses tracking of face
                document.addEventListener("clmtrackrLost", function(event) {
                    ctrack.stop();
                    alert("The tracking had problems converging on a face in this image. Try selecting the face in the image manually.")
                }, false);
                
                // detect if tracker has converged
                document.addEventListener("clmtrackrConverged", function(event) {
                    document.getElementById('convergence').innerHTML = "CONVERGED";
                    document.getElementById('convergence').style.backgroundColor = "#00FF00";
                    // stop drawloop
                    cancelRequestAnimFrame(drawRequest);
                }, false);
                
                // update stats on iteration
                document.addEventListener("clmtrackrIteration", function(event) {
                    stats.update();
                }, false);

                // manual selection of faces (with jquery imgareaselect plugin)
                function selectBox() {
                    overlayCC.clearRect(0, 0, 720, 576);
                    document.getElementById('convergence').innerHTML = "";
                    ctrack.reset();
                    $('#overlay').addClass('hide');
                    $('#image').imgAreaSelect({
                        handles : true,
                        onSelectEnd : function(img, selection) {
                            // create box
                            var box = [selection.x1, selection.y1, selection.width, selection.height];
                            
                            // do fitting
                            animate(box);
                            $('#overlay').removeClass('hide');
                        },
                        autoHide : true
                    });
                }
                function convertCanvasToImage(canvas) {
    var image = new Image();
    image.src = canvas.toDataURL("image/png");
    return image;
}
                    function tracker(){

                              var img = convertCanvasToImage(document.getElementById('image'));

      var tracker = new tracking.ObjectTracker(['face', 'eye', 'mouth']);
      tracker.setStepSize(1.7);

      tracking.track(img, tracker);

      tracker.on('track', function(event) {
        event.data.forEach(function(rect) {
          window.plot(rect.x, rect.y, rect.width, rect.height);
        });
      });

      window.plot = function(x, y, w, h) {
        var rect = document.createElement('div');
        document.querySelector('.demo-container').appendChild(rect);
        rect.classList.add('rect');
        rect.style.width = w + 'px';
        rect.style.height = h + 'px';
        rect.style.left = (img.offsetLeft + x) + 'px';
        rect.style.top = (img.offsetTop + y) + 'px';
      };
                    }
                    function facedetect(){
                            $('#image').faceDetection({
        complete: function (faces) {
            console.log(faces);

                $('.face').remove();
                $('#image').faceDetection({
                    complete: function (faces) {                        
                        for (var i = 0; i < faces.length; i++) {
                            $('<div>', {
                                'class':'face',
                                'css': {
                                    'position': 'absolute',
                                    'left':     faces[i].x * faces[i].scaleX + 'px',
                                    'top':      faces[i].y * faces[i].scaleY + 'px',
                                    'width':    faces[i].width  * faces[i].scaleX + 'px',
                                    'height':   faces[i].height * faces[i].scaleY + 'px'
                                }
                            })
                            .insertAfter(this);
                        }
                    },
                    error:function (code, message) {
                        alert('Error: ' + message);
                    }
                });
        }
    });
                    }
            </script>
    <canvas width="11px" height="781px" id="renderCanvas" style="display:none;"></canvas>
</body>

</html>